define(["jquery","core/ajax","core/str","core/notification","local_mxschool/locallib"],function(a,b,c,d,e){function f(){var f=b.call([{methodname:"local_peertutoring_get_tutor_options",args:{userid:a(".mx-form select#id_tutor").val()}}]);f[0].done(function(b){e.updateSelect(a(".mx-form select#id_student"),b.students),a.when(c.get_string("form:select:default","local_mxschool")).done(function(c){b.departments.unshift({value:0,text:c}),e.updateSelect(a(".mx-form select#id_department"),b.departments)})}).fail(d.exception)}function g(){var f=b.call([{methodname:"local_peertutoring_get_department_courses",args:{department:a(".mx-form select#id_department").val()}}]);f[0].done(function(b){a.when(c.get_string("form:select:default","local_mxschool")).done(function(c){b.unshift({value:0,text:c}),e.updateSelect(a(".mx-form select#id_course"),b)})}).fail(d.exception)}return{setup:function(){a(document).ready(function(){f(),g()}),a(".mx-form select#id_tutor").change(f),a(".mx-form select#id_department").change(g)}}});