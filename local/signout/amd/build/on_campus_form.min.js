define(["jquery","core/ajax","core/str","core/notification","local_mxschool/locallib"],function(a,b,c,d,e){function f(){a(".mx-form div#fitem_id_location_warning").children().eq(1).children().eq(0).addClass("text-warning")}function g(){var f=b.call([{methodname:"local_signout_get_on_campus_student_options",args:{userid:a(".mx-form select#id_student").val(),locationid:a(".mx-form select#id_location_select").val()}}]);f[0].done(function(b){a.when(c.get_string("form:select:default","local_mxschool"),c.get_string("on_campus:form:info:location_select:other","local_signout")).done(function(c,d){b.locations.unshift({value:0,text:c}),b.locations.push({value:-1,text:d}),e.updateSelect(a(".mx-form select#id_location_select"),b.locations)});var d=a(".mx-form fieldset#id_permissions"),f=d.children().eq(1).children().eq(0).children().eq(1).children().eq(0);b.warning?(f.html(b.warning),d.next().hide(),d.show()):(f.text(""),d.next().show(),d.hide())}).fail(d.exception)}return{setup:function(){a(document).ready(function(){f(),g()}),a(".mx-form select#id_student").change(g),a(".mx-form select#id_location_select").change(g)}}});