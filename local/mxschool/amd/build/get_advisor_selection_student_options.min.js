define(["jquery","core/ajax","core/str","core/notification"],function(a,b,c,d){function e(){var e=a(".mx-form input#id_keepcurrent_0"),f=a(".mx-form fieldset#id_options"),g=a(".mx-form fieldset#id_deans");e.prop("checked")?f.show():f.hide(),"0"===a('.mx-form input[name="isstudent"]').val()?g.show():g.hide();var h=b.call([{methodname:"local_mxschool_get_advisor_selection_student_options",args:{userid:a(".mx-form select#id_student").val()}}]);h[0].done(function(b){var d=a(".mx-form select#id_student"),f=d.val(),g=a(".mx-form select#id_student > option[value="+f+"]").text();d.empty(),a.each(b.students,function(b,c){d.append(a("<option></option>").attr("value",c.userid).text(c.name))}),"0"!==a('.mx-form input[name="id"]').val()&&(a(".mx-form select#id_student > option[value="+f+"]").length||d.prepend(a("<option></option>").attr("value",f).text(g))),a(".mx-form select#id_student > option[value="+f+"]").length?d.val(f):d.change(),a(".mx-form fieldset#id_info div.form-control-static").eq(0).text(b.current.name);var h=a('.mx-form div[data-groupname="keepcurrent"]'),i=a(".mx-form fieldset#id_info div.form-control-static").eq(1).parent().parent();b.closing?(h.hide(),e.prop("checked")||(e.prop("checked",!0),h.change()),i.show()):(i.hide(),h.show()),a.when(c.get_string("form_select_default","local_mxschool")).done(function(c){function d(b,c){h.append(a("<option></option>").attr("value",c.userid).text(c.name))}function e(a){return a.userid==i}b.available.splice(b.available.findIndex(function(a){return a.userid===b.current.userid}),1),b.available.unshift({userid:0,name:c});for(var f=!0,g=1;g<=5;g++){var h=a(".mx-form select#id_option"+g),i=h.val();h.empty(),a.each(b.available,d),a(".mx-form select#id_option"+g+" > option[value="+i+"]").length?h.val(i):h.change();var j=h.parent().parent();f?j.show():j.hide(),0==i?f=!1:(b.available.splice(b.available.findIndex(e),1),i==b.current.userid&&(f=!1)),1!==g||b.closing||b.available.splice(1,0,b.current)}})}).fail(d.exception)}return function(){a(document).ready(e),a(".mx-form select#id_student").change(e),a('.mx-form div[data-groupname="keepcurrent"]').change(e),a(".mx-form select#id_option1").change(e),a(".mx-form select#id_option2").change(e),a(".mx-form select#id_option3").change(e),a(".mx-form select#id_option4").change(e),a(".mx-form select#id_option5").change(e)}});