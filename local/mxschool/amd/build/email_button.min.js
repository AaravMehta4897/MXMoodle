define(["jquery","core/str","core/ajax","core/notification"],function(a,b,c,d){function e(){var e=a(this),f=c.call([{methodname:"local_mxschool_send_email",args:{emailclass:e.attr("name"),emailparams:{id:e.val()}}}]);f[0].done(function(){a.when(b.get_string("email_button_sent","local_mxschool")).done(function(a){var b=e.text();e.text(a),setTimeout(function(){e.trigger("hideButton"),setTimeout(function(){e.text(b)},1e3)},1e3)})}).fail(d.exception)}function f(){a(this).show("slow"),a(this).parent().children('span:contains(" ")').remove(),a(this).before(a("<span></span>").text(" "))}function g(){a(this).hide("slow"),a(this).parent().children('span:contains(" ")').remove()}return function(b,c,d){var h=a('button.mx-email-button[value="'+b+'"][name="'+c+'"]');if(h.click(e),d){h.on("showButton",f),h.on("hideButton",g);var i=h.parent().children("input.mx-checkbox");i&&(i.on("checkboxEnabled",function(){h.trigger("showButton")}),i.on("checkboxDisabled",function(){h.trigger("hideButton")}))}else h.show()}});