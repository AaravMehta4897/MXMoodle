define(["jquery","core/str","core/ajax","core/notification"],function(a,b,c,d){function e(){var e=a(this),f=c.call([{methodname:"local_mxschool_send_email",args:{emailclass:e.attr("name"),emailparams:{id:e.val()}}}]);f[0].done(function(){a.when(b.get_string("email_button_sent","local_mxschool")).done(function(a){e.text(a),setTimeout(function(){e.trigger("hideButton")},1e3)})}).fail(d.exception)}function f(){a(this).show("slow"),a(this).before(a("<span></span>").text(" "))}function g(){a(this).hide("slow"),a(this).parent().children('span:contains(" ")').remove()}return function(b,c,d){var h=a('button.mx-email-button[value="'+b+'"][name="'+c+'"]');h.click(e),d?(h.on("showButton",f),h.on("hideButton",g)):h.show()}});